<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - RHHS Admin</title>
    <link rel="icon" href="images/logo.png" type="image/png">
<link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/login.css">
</head>
<body>
<main class="main-content">
    <div class="login-container">
        <img src="images/logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" class="login-logo">
        <h1>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
        <p class="subtitle">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</p>

        <div id="error-message" class="error-message"></div>

        <form id="login-form">
            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                <input type="email" id="email" required placeholder="admin@rhhs.edu.lb">
            </div>

            <div class="form-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            </div>

            <button type="submit" id="login-btn" class="btn btn-login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </form>

        <div id="loading" class="loading">
            <div class="spinner"></div>
        </div>

        <div class="back-link">
            <a href="index.html">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</a>
        </div>
    </div>
</main>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    
    <script src="js/firebase-config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for Firebase to be fully loaded
            if (typeof firebase === 'undefined') {
                console.error('Firebase not loaded properly');
                return;
            }
            
            // Ensure auth is available
            if (typeof window.auth === 'undefined') {
                console.error('Firebase Auth not initialized properly');
                return;
            }
            
            const loginForm = document.getElementById('login-form');
            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            const loginBtn = document.getElementById('login-btn');
            const errorMessage = document.getElementById('error-message');
            const loading = document.getElementById('loading');

            const urlParams = new URLSearchParams(window.location.search);
            const redirectTo = urlParams.get('redirect') || 'admin.html';

            window.auth.onAuthStateChanged((user) => {
                if (user) {
                    window.location.href = redirectTo;
                }
            });

            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const email = emailInput.value.trim();
                const password = passwordInput.value;

                errorMessage.classList.remove('show');
                loginBtn.disabled = true;
                loading.classList.add('show');

                try {
                    await window.auth.signInWithEmailAndPassword(email, password);
                    window.location.href = redirectTo;
                } catch (error) {
                    console.error('Login error:', error);
                    
                    let message = 'Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.';
                    
                    if (error.code === 'auth/user-not-found') {
                        message = 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.';
                    } else if (error.code === 'auth/wrong-password') {
                        message = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.';
                    } else if (error.code === 'auth/invalid-email') {
                        message = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­.';
                    } else if (error.code === 'auth/too-many-requests') {
                        message = 'Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒØ«ÙŠØ±Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹.';
                    }
                    
                    errorMessage.textContent = message;
                    errorMessage.classList.add('show');
                    loginBtn.disabled = false;
                    loading.classList.remove('show');
                }
            });
        });
    </script>

    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-logos">
                <img src="images/logo.png" alt="Logo 1" class="footer-logo">
                <img src="images/logo2.png" alt="Logo 2" class="footer-logo">
            </div>
            <div class="footer-links">
                <a href="about.html">Ø¹Ù† Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</a>
            <a href="about.html"> ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†</a>
            </div>
            <div class="copyright">
                &copy; 2025 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø±ÙÙŠÙ‚ Ø§Ù„Ø­Ø±ÙŠØ±ÙŠ.
            </div>
        </div>
    </footer>
</body>
</html>
